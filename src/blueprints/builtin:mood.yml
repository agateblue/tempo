{
  "id": "builtin:mood",
  "label": "Mood",
  "title": "Mood-related charts and visualizations",
  "version": "1",
  "visualizations": [
    {
      "label": "Mood by period: {{ groupByPeriodLabel }}",
      "help": "Higher is better",
      "query": "SELECT {{ groupByPeriod }}, sum(CASE WHEN mood > 0 THEN mood ELSE 0 END) as Positive, sum(CASE WHEN mood < 0 THEN mood ELSE 0 END) as Negative FROM ? GROUP BY {{ groupByPeriod }} ORDER BY {{ groupByPeriod }} DESC",
      "displayType": "bar",
      "displayOptions": {
        "colors": ["green", "orange"]
      }
    },
    {
      "label": "Mood instability by period: {{ groupByPeriodLabel }}",
      "help": "Lower is stabler",
      "query": "Select {{ groupByPeriod }}, (min(posmood, abs(negmood)) / max(max(posmood, abs(negmood)), 1)) as instability From (SELECT {{ groupByPeriod }}, sum(CASE when mood>0 then mood else 0 END) as posmood,  sum(CASE when mood<0 then mood else 0 END) AS negmood FROM ? GROUP BY {{ groupByPeriod }} ORDER BY {{ groupByPeriod }} DESC)",
      "displayType": "bar",
      "displayOptions": {
        "colors": ["purple"]
      }
    }
  ]
}